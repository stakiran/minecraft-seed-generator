<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minecraft Seed Generator</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 24px; max-width: 760px; }
    h1 { font-size: 20px; margin: 0 0 12px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; }
    .seed { font-size: 22px; font-weight: 700; word-break: break-all; padding: 10px 12px; border: 1px solid #eee; border-radius: 10px; background: #fafafa; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    button { padding: 10px 14px; border-radius: 10px; border: 1px solid #ddd; background: white; cursor: pointer; }
    button:hover { background: #f3f3f3; }
    .meta { color: #666; font-size: 12px; margin-top: 10px; }
    .toast { margin-top: 10px; font-size: 12px; color: #0a7; min-height: 16px; }
    input[type="text"] { width: 100%; padding: 10px 12px; border: 1px solid #eee; border-radius: 10px; font-size: 14px; }
  </style>
</head>
<body>
  <h1>Minecraft Seed Generator</h1>

  <div class="card">
    <div class="seed" id="seedText">-</div>

    <div class="row">
      <button id="btnNew">ğŸ² New</button>
      <button id="btnCopy">ğŸ“‹ Copy</button>
    </div>

    <div class="meta">
      64-bit signed integer (long) ã‚’ç”Ÿæˆã—ã¾ã™ã€‚0 ã¯é¿ã‘ã¾ã™ã€‚è¡¨ç¤ºã¯10é€²æ•°ã€‚
    </div>
    <div class="toast" id="toast"></div>

    <div style="margin-top:14px;">
      <div class="meta" style="margin:0 0 6px;">æ‰‹å‹•ã§è²¼ã‚Šä»˜ã‘ãŸã„å ´åˆï¼ˆã‚³ãƒ”ãƒ¼å¤±æ•—æ™‚ã®ä¿é™ºï¼‰</div>
      <input id="seedInput" type="text" readonly />
    </div>
  </div>

  <script>
    // ---- 64-bit signed integer generator using BigInt ----
    // Returns BigInt in range [-2^63, 2^63-1], excluding 0.
    function randomInt64NonZero() {
      const buf = new Uint8Array(8);
      crypto.getRandomValues(buf);

      // Convert to unsigned 64-bit BigInt (little-endian)
      let u = 0n;
      for (let i = 0; i < 8; i++) {
        u |= BigInt(buf[i]) << (8n * BigInt(i));
      }

      // Map to signed range
      const TWO63 = 1n << 63n;
      let s = (u >= TWO63) ? (u - (1n << 64n)) : u; // now in [-2^63, 2^63-1]

      // Avoid 0 (and you can also avoid MIN_VALUE if you want)
      if (s === 0n) s = 1n;
      return s;
    }

    const seedText = document.getElementById("seedText");
    const seedInput = document.getElementById("seedInput");
    const toast = document.getElementById("toast");

    function setToast(msg) {
      toast.textContent = msg;
      if (msg) setTimeout(() => (toast.textContent = ""), 1500);
    }

    function newSeed() {
      const s = randomInt64NonZero().toString(10);
      seedText.textContent = s;
      seedInput.value = s;
      setToast("ç”Ÿæˆã—ã¾ã—ãŸ");
    }

    async function copySeed() {
      const s = seedText.textContent;
      try {
        await navigator.clipboard.writeText(s);
        setToast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      } catch (e) {
        // Fallback: select the input so user can Ctrl+C
        seedInput.focus();
        seedInput.select();
        setToast("ã‚³ãƒ”ãƒ¼å¤±æ•—: å…¥åŠ›æ¬„ã‚’é¸æŠã—ãŸã®ã§ Ctrl+C ã—ã¦ãã ã•ã„");
      }
    }

    document.getElementById("btnNew").addEventListener("click", newSeed);
    document.getElementById("btnCopy").addEventListener("click", copySeed);

    // Auto-generate on load
    newSeed();
  </script>
</body>
</html>
